from google import genai
from google.genai import types
import PIL.Image

# ---------------------------------------------------------
# 1. API í‚¤ ì„¤ì • (ë³¸ì¸ì˜ í‚¤ë¥¼ ë„£ì–´ì£¼ì„¸ìš”)
# ---------------------------------------------------------
import os

# [ìˆ˜ì • ì „]
# [ìˆ˜ì • í›„] ì†ŒìŠ¤ì½”ë“œì—ëŠ” í‚¤ë¥¼ ì—†ì• ê³ , í™˜ê²½ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜¤ë„ë¡ ë³€ê²½
API_KEY = os.environ.get("GEMINI_API_KEY") 

if not API_KEY:
    raise ValueError("API Keyê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!")
# 2. í´ë¼ì´ì–¸íŠ¸ ìƒì„± (ì´ê²Œ ìƒˆë¡œìš´ ë°©ì‹ì…ë‹ˆë‹¤!)
client = genai.Client(api_key=API_KEY)
print("ğŸ” ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë¸ ëª©ë¡:")
try:
    # ë³µì¡í•œ í•„í„°ë§ ë‹¤ ë¹¼ê³  ì´ë¦„ë§Œ ì¶œë ¥!
    for m in client.models.list():
        print(f"- {m.name}")
except Exception as e:
    print(f"âŒ ì—ëŸ¬: {e}")
# ---------------------------------------------------------
# 3. ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°
# ---------------------------------------------------------
image_path = "poster.jpg"  # ì´ë¯¸ì§€ íŒŒì¼ëª… í™•ì¸!

try:
    img = PIL.Image.open(image_path)
    print(f"âœ… ì´ë¯¸ì§€ ë¡œë“œ ì„±ê³µ: {image_path}")
except FileNotFoundError:
    print("âŒ ì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŒŒì¼ëª…ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")
    exit()

# ---------------------------------------------------------
# 4. API ì½œ ë‚ ë¦¬ê¸° (Gemini 1.5 Flash)
# ---------------------------------------------------------
print("ğŸ¤– AIì—ê²Œ ì§ˆë¬¸ì„ ë³´ë‚´ëŠ” ì¤‘ì…ë‹ˆë‹¤...")

try:
    response = client.models.generate_content(
    model="gemini-flash-lite-latest",
        contents=[
            "ì´ ì´ë¯¸ì§€ëŠ” í•™êµ ê³µì§€ì‚¬í•­ í¬ìŠ¤í„°ì•¼. í•µì‹¬ ë‚´ìš©ì„ 3ì¤„ë¡œ ìš”ì•½í•´ì£¼ê³ , ë¶„ë¥˜(ì±„ìš©/ê³µëª¨ì „/í–‰ì‚¬)ë¥¼ í•´ì¤˜. ì¼ì‹œì™€ ì¥ì†Œ, í‚¤ì›Œë“œë„",
            img
        ]
    )
    
    # 5. ê²°ê³¼ ì¶œë ¥
    print("\n" + "="*30)
    print("ğŸ“¢ AIì˜ ë¶„ì„ ê²°ê³¼")
    print("="*30)
    print(response.text)

except Exception as e:
    print(f"âŒ ì—ëŸ¬ ë°œìƒ: {e}")
